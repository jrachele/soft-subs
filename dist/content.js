({265:function(){var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function l(e){try{d(o.next(e))}catch(e){r(e)}}function c(e){try{d(o.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,c)}d((o=o.apply(e,t||[])).next())}))},t=!0,n="ch",o=97,i=80;function r(){var e=document.querySelector("video");return null===e?0:e.videoHeight*(i/100)}function l(){return e(this,void 0,void 0,(function*(){if(!t)return;let e=document.createElement("canvas"),i=e.getContext("2d"),l=r();e.width=this.videoWidth,e.height=this.videoHeight,i.drawImage(this,0,0,e.width,e.height);let[d,a,s,h]=[0,l,this.videoWidth,this.videoHeight-l];console.log(d,a,s,h);var u=document.createElement("canvas"),f=u.getContext("2d");u.width=s,u.height=h,f.drawImage(e,d,a,s,h,0,0,u.width,u.height);let v=u.toDataURL("image/png");fetch(`http://localhost:5000/ocr/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:v})}).then((e=>e.json())).then((e=>function(e,n){if(!t)return;if(c(),void 0===n)return;if(null==(n=n[0]))return;let i=r();n.forEach((t=>{var[n,r]=t,[l,c]=r;if(c<o/100)return void console.log(`Confidence low, throwing out ${l}, (confidence ${c})`);var[d,a,s,h]=n;console.log(n);var u=h[1]-d[1];let f=e.getBoundingClientRect(),v=[f.width/e.videoWidth,f.height/e.videoHeight],g=document.createElement("div");g.classList.add("soft-sub"),g.style.position="absolute",g.style.fontSize=u*v[1]*.9+"px",g.style.left=`${d[0]*v[0]+f.left}px`,g.style.top=`${(d[1]+i)*v[1]+f.top}px`,g.style.backgroundColor="#ffffffcc",g.innerHTML=l,document.body.appendChild(g),console.log(g)}))}(this,e))).catch((e=>{console.error("Error:",e)}))}))}function c(){document.querySelectorAll(".soft-sub").forEach(((e,t,n)=>e.parentElement.removeChild(e)))}function d(e,r){for(let[l,{oldValue:c,newValue:d}]of Object.entries(e))"enabled"===l?t=d:"lang"===l?n=d:"confidence"===l?o=d:"screenRegion"===l&&(i=d),console.log(`Storage key "${l}" in namespace "${r}" changed.`,`Old value was "${c}", new value is "${d}".`);if(t){let e=document.querySelector("video");l.call(e)}else c()}!function(){e(this,void 0,void 0,(function*(){console.log("Soft Subs Preload"),chrome.storage.onChanged.addListener(d);var e=document.querySelector("video");null!==e?(e.addEventListener("pause",l),e.addEventListener("play",c),e.addEventListener("change",c),e.addEventListener("keypress",c),e.addEventListener("resize",l)):console.log("Video is null!")}))}()}})[265]();