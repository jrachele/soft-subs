({265:function(){var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(i,r){function d(e){try{l(o.next(e))}catch(e){r(e)}}function c(e){try{l(o.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(d,c)}l((o=o.apply(e,t||[])).next())}))},t=!0,n="ch",o=97,i=80,r=null;function d(){return null===r?0:r.videoHeight*(i/100)}function c(){return e(this,void 0,void 0,(function*(){if(!t)return;let e=document.createElement("canvas"),i=e.getContext("2d"),c=d();e.width=this.videoWidth,e.height=this.videoHeight,i.drawImage(this,0,0,e.width,e.height);let[a,u,s,h]=[0,c,this.videoWidth,this.videoHeight-c];var f=document.createElement("canvas"),v=f.getContext("2d");f.width=s,f.height=h,v.drawImage(e,a,u,s,h,0,0,f.width,f.height);let m=f.toDataURL("image/png");fetch(`http://localhost:5000/ocr/${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:m})}).then((e=>e.json())).then((e=>{!function(e,n){if(!t)return;if(l(),void 0===n)return;if(null==(n=n[0]))return;let i=d();n.forEach((e=>{var[t,n]=e,[d,c]=n;if(c<o/100)return void console.log(`Confidence low, throwing out ${d}, (confidence ${c})`);var[l,a,u,s]=t,h=s[1]-l[1];let f=r.getBoundingClientRect(),v=[f.width/r.videoWidth,f.height/r.videoHeight],m=document.createElement("div");m.classList.add("soft-sub"),m.style.position="absolute",m.style.zIndex="2147483647",m.style.fontSize=h*v[1]*.9+"px",m.style.left=`${l[0]*v[0]+(f.left+document.documentElement.scrollLeft)}px`,m.style.top=`${(l[1]+i)*v[1]+(f.top+document.documentElement.scrollTop)}px`,m.style.backgroundColor="#ffffffcc",m.innerHTML=d,document.body.appendChild(m)}))}(0,e)})).catch((e=>{console.error("Error:",e)}))}))}function l(){document.querySelectorAll(".soft-sub").forEach(((e,t,n)=>e.parentElement.removeChild(e)))}function a(e,d){for(let[r,{oldValue:c,newValue:l}]of Object.entries(e))"enabled"===r?t=l:"lang"===r?n=l:"confidence"===r?o=l:"screenRegion"===r&&(i=l),console.log(`Storage key "${r}" in namespace "${d}" changed.`,`Old value was "${c}", new value is "${l}".`);t?c.call(r):l()}(function(e,t=3e4){return new Promise(((n,o)=>{let i,r=setTimeout((()=>{i&&i.disconnect(),o(new Error("Element did not load within the specified timeout"))}),t);i=new MutationObserver((t=>{document.querySelector(e)&&(clearTimeout(r),i.disconnect(),n(document.querySelector(e)))})),i.observe(document.body,{childList:!0,subtree:!0})}))})("video").then((function(t){return e(this,void 0,void 0,(function*(){chrome.storage.onChanged.addListener(a),null!==t?(r=t,console.log("SoftSubs Loaded."),r.addEventListener("pause",c),r.addEventListener("play",l),r.addEventListener("timeupdate",(function(){l(),r.paused&&c.call(r)})),window.addEventListener("resize",(function(){l(),r.paused&&c.call(r)})),document.addEventListener("fullscreenchange",(function(){l(),r.paused&&c.call(r)})),window.addEventListener("beforeunload",l),new MutationObserver((e=>{e.forEach((e=>{"attributes"===e.type&&"style"===e.attributeName&&(l(),r.paused&&c.call(r))}))})).observe(r,{attributes:!0})):console.log("Video is null!")}))})).catch((e=>console.error("Softsubs was unable to retrieve a video on this page:",e)))}})[265]();